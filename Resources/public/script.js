$(document).ready(function(){function t(){var t=[{data:"domain"},{data:"key"}];return $.each(n,function(a,n){t.push({data:"messages."+n+".message"})}),t.push({}),t}function a(t,a,n){t.html(""),"input"==n?(a="[No message]"==a?"":a,t.append('<input class="translation-input" value="'+a+'">'),s=a,t.find("input").focus()):(a=""==a?"[No message]":s,t.append('<span class="translation-message">'+a+"</span>"))}var n,e,s;$.ajax({url:Routing.generate("ongr_translations_list_get_locales"),success:function(t){n=t;for(var a=[],s=2;s<t.length+2;s++)a.push(s);e=a},async:!1});var i=$("#translations").DataTable({ajax:{url:Routing.generate("ongr_translations_list_get_translations"),dataSrc:""},stateSave:!0,columns:t(),columnDefs:[{targets:e,orderable:!1,render:function(t,a,n,e){return'<span class="translation-message">'+t+"</span>"}},{targets:-1,render:function(t,a,n){return'<a class="edit btn btn-primary btn-xs" data-toggle="modal" data-target="#setting-edit">Edit</a>&nbsp;<a class="delete delete-setting btn btn-danger btn-xs" data-name="'+n.name+'">Delete</a>'}}]});$("#translations tbody").on("click","span.translation-message",function(){a($(this).parent(),$(this).text(),"input")}),$("#translations tbody").on("keyup","input.translation-input",function(t){if([13,38,40].indexOf(t.keyCode)!=-1){var n=i.row($(this).parents("tr")).data(),e=i.column($(this).parents("td")).index(),r=$(i.column($(this).parents("td")).header()).html(),o=$(this).val(),l=this;s!=o&&($.ajax({url:Routing.generate("ongr_translations_api_edit_message"),data:JSON.stringify({message:o,id:n.id,locale:r}),method:"post"}),s=o);var p;switch(t.keyCode){case 13:a($(l).parent(),o,"span");break;case 38:p=$(l).parents("tr").prev().find("td")[e],a($(l).parent(),o,"span"),a($(p),$(p).find("span").text(),"input");break;case 40:p=$(l).parents("tr").next().find("td")[e],a($(l).parent(),o,"span"),a($(p),$(p).find("span").text(),"input")}}else 27==t.keyCode&&a($(this).parent(),$(this).val(),"span")}),$("#translations tbody").on("blur","input.translation-input",function(t){a($(this).parent(),$(this).val(),"span")})});